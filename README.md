# LinkTowerDefence
---
## 프로젝트 계획 이유
과거 재밌게 봤던 유희왕 시리즈가 최근 [유희왕 마스터 듀얼](https://www.konami.com/yugioh/masterduel/)이란 게임으로 출시된 것을 들었다. 하지만 내가 마지막으로 즐겼던 시절은 싱크로 소환까지 였기에 엑시즈 소환, 링크 소환이니...게다가 듀얼하는 모습을 보니 1~2턴에 필드 모습이 내가 보았던 모습과 달리 전개가 엄청났었다. 그래서 그동안 어떻게 변해왔나를 보며 룰과 금제리스트를 쭉 보던 중, 링크 소환이란 걸 봤다. 이 내용들을 읽다 보니 문득 풍선타워디펜스가 떠오르며 다음과 같은 생각이 떠올랐다.
 
>링크 소환의 결과인 링크몬스터의, 링크 마커를 이용해 타워 디펜스를 만들어 볼까?

그래서 이 프로젝트 이름을 이렇게 정해서 시작하기로 했다.

---
## 기존의 타워 디펜스

타워디펜스류의 게임으론 풍선타워디펜스(풍타디), 식물 vs 좀비 그리고 조사로 알게된 TowerBattles 가 있다. 중점적으로 볼 것은 타워의 종류들과 진행 방식이다.

### 게임 방식
- 밀려오는 적을 막으면 된다.
- 막는 방법으론 적을 없애면 된다.
- 이는 타워들을 이용하면 된다.
- 타워는 칸 단위, 혹은 자유롭게 지을 수 있다.
- 1회용 스킬이 있는 경우도 있다.
- 타워나 스킬은 업그레이드가 가능하다.
- 보통 자신의 기지가 파괴되면 그것으로 게임오버가 된다.

### 타워
- 타워의 종류들은 크게 공격(Attack)형, 보조(Support)형으로 구분할 수 있다.
- 공격형 타워는 공격 타입과 공격 방식으로 나눌 수 있다.
    - 공격 타입으로는 비관통, 관통, 스플래시등 데미지를 어떻게 주느냐, 적의 종류에 따라 대공형등, 어떤 적들을 공격하느냐에 따라 나눌 수 있다.
    - 공격 방식으론 적을 인식하면 인식한 적을 공격하거나, 공격 지점이나 방향을 고정하면 해당하는 곳으로 공격하는 것(`지점형 공격`이라 하겠다)으로 나눌 수 있다.
- 보조형 타워는 타워 버프형, 적 디버프형, 자원지원형 으로 나눌 수 있다.
    - 타워 버프형으론 공격 타워의 성능을 향상 시키는 타입이다
    - 적 디버프형은 적의 이동속도 감소, 방어력 감소와 같이 적의 능력을 약화시키는 타입이다.
    - 자원지원형은 게임에 사용되는 코스트들의 획득량을 늘려주는 타입이다.
- 자원지원형과 지점형 공격타워를 제외한 타워들은 모두 적을 인식하거나 아군 타워에 영향을 줄 수 있는 범위가 있다.

### 업그레이드
- 대부분의 타워는 인식 범위에 대한 업그레이드가 있다.
- 공격 타워의 업그레이드는 가하는 데미지를 증가시키는 데미지 업그레이드, 공격 타입을 바꿔주는 타입 업그레이드, 공격가능한 적을 늘리는 업그레이드가 있다.
- 보조형 타워는 버프,디버프의 범위를 늘리는 업그레이드, 효력을 증가시키는 업그레이드가 있다.

---

## 용어 정의

### 타워
- 타워는 크게 2종류로 링크를 가지고 있는 `링크 타워`, 링크를 가지고 있지 않는 `일반 타워`가 있다.

### 링크(link)
- 유희왕에 있는 `링크 마커` 와 매우 유사하다. 이는 8개의 방향을 가진 화살표이다. 
- 보조형 타워가 가진 `링크` 는 보조형 타워 배치되었을때 이 타워를 기준으로 영향을 줄 수 있는 공격형 타워의 위치라 생각하면 된다. 

### 링킹(linking)
- `링크 타워 A` 에 있는 `링크 마커` 에 `다른 타워 B`가 있다면 `B` 는 `A` 에 `링킹` 되었다고 한다.

---

# To Do List
- [x] 게임 세부 규칙 설정
    - 게임은 `스테이지` 단위로 `보드판` 형식의 판 위에서 진행한다.
    - 보드판의 각 칸은 `적이 이동하는 경로`, `타워를 설치할 수 있는 칸`, `타워를 설치할 수 없는칸` 으로 구분한다. `적이 이동하는 경로` 에는 `타워`를 설치할 수 없다.
    - 스테이지의 `클리어 조건`은 해당 스테이지가 종료됐을 때, `기지`가 무너지지 않으면 된다.
    - 모든 `적`은 `시작 지점`에서 기지 쪽으로 `정해진 경로`로 움직인다.
    - 적이 기지에 도착하면 기지의 `체력`이 감소한다.
    - 적을 처치하면 `재화 G`를 얻는다.
    - `G` 로는 `타워`를 구매하거나 `링크 타워` 를 강화할 수 있다. 
- [x] 링크 타워 설정
    - `링크 타워` 는 `2`가지가 있다.
        - `타워`에 `강화 능력`을 전달하는 `파워 타워`
        - `파워 타워`나 `링킹 타워`에 `링킹`되어 `해당 타워`가 전달받은 강화를 `자신이 가진 링크` 의 방향으로 다시 전달하는 `링킹 타워`
    - `링크 타워` 를 강화하면 `링크` 수를 늘러가나 `강화 능력` 을 향상 시킬 수 있다.
- [x] 일반 타워 설정
    - 일반 타워는 `공격 타워`와 `지원 타워`로 구분된다.
        - `공격 타워`는 `2`개의 속성 `공격 방식` 과 `공격 종류` 로 구성된 하나의 튜플로 구분한다.
            - `공격 방식` 은 `인식형 공격` 과 `지점형 공격` 이 있다.
                - `인식형 공격` 은 `일정 범위` 내에 `적`이 있다면 해당 `적`이 `범위` 를 벗어나거나 `적`이 죽기전까지 해당 `적` 을 공격하는 방식이다.
                - `지점형 공격` 은 `맵` 의 한 지점을 선택해서 `해당 지점` 방향으로 `일정 주기` 마다 공격하는 방식이다.
            - `공격 종류` 는 `일반`, `관통`, `범위` 가 있다.
                - `일반` 은 `공격` 1회당 `적` 1마리에게 `데미지`를 주는 공격이다.
                - `관통` 은 `공격` 1회당 `타워` 가 공격하는 방향에 있는 모든 `적`에게 `데미지` 를 주는 공격이다.
                - `범위` 는 `공격` 1회당 `공격 지점 주변의 일정 범위` 에 있는 모든 `적` 에게 `데미지`를 주는 공격이다.
        - `지원 타워`는 `자원 타워` 와 `디버프 타워` 가 있다.
            - `자원 타워` 는 `재화` 의 획득량을 증가시켜준다.
            - `디버프 타워` 는 `적` 들에게 능력을 약화시키는 `디버프`를 거는 타워이다. 이는 `2` 가지 유형이 존재한다.
                - `패시브 디버프 타워` 는 `설치된 타워의 위치` 를 기준으로 `일정 범위`에 `디버프` 를 거는 타워이다.
                - `액티브 디버프 타워` 는 `인식형 공격` 과 같이 작동하여 `적`의 위치를 기준으로 `일정 시간` 마다 `디버프` 를 거는 타워이다.
- [x] `강화 능력` 설정
    - `파워 타워` 의 `강화 능력`의 종류는 `일반 강화` 와 `고유 강화` 가 있다.
        - `일반 강화` 는 서로 다른 `파워 타워` 에서 받은 `강화 능력` 중, 중첩이 가능한 `강화 능력` 이다. 
            - `공격 타워 A` 가 `파워 타워 B C` 로 부터 받은 `강화 능력`이 있다면 이를 합치는 것이다.
        - `고유 강화` 는 `일반 강화` 와 반대로 서로 다른 `파워 타워` 에서 받은 `강화 능력` 중, 중첩이 불가능한 `강화 능력` 이다.
            - 만약 이것이 겹친다면 `더 많이 강화되는 쪽`이 적용된다.
        - `동일한 파워 타워` 에서 전달된 `강화 능력` 은 중첩되지 않는다. (2022/03/18 추가)   

- [x] 리소스 찾기


- [x] 강화 경로 구하기 알고리즘
    - 위와 같은 테이블에서 $k$ 개의 `파워 타워` 들의 강화능력이 어떤 경로로 이어지는질 어떻게 구할 것인가? ($O(NM)$ 이하)
        - 먼저 연결된 타워들의 모습을 그래프형태로 그릴 수 있다.
        - 이때 각 그래프마다 단절점을 찾는다.
        - 그리고 단절점을 기준으로 역방향으로 탐색을 하며 파워타워들을 찾는다.
        - 그리고 정방향으로 탐색하며 연결된 기본타워를 찾는다.
        - 이 둘을 연결하면 끝!

- [x] 타워 연결 / 해체 알고리즘 구현
    - $N \times M$ 의 격자판에 타워를 배치한다. 타워는 위의 타워를 배치한다. 격자에 배치되어있는 타워들의 상태에서 임의의 위치에 어떤 타워를 배치하거나 링크타워를 제거하면 공격 타워들의 상태가 바뀌는데 어떻게 바꿀 것인가? ($O(NM)$ 이하)
        - 해제 알고리즘
            - 만약 `파워 타워` 라면 `링크` 를 따라가며 연결된 `일반 타워` 와 `링킹 타워` 의 상태를 전환한다.
            - `링킹 타워` 인 경우, `단절점` 인지를 확인해서 단절점이 아니면 상태는 그대로 이다.
            - 만약 `단절점` 이라면 `단절점` 을 기준으로 각 `그래프` 에 연결되어있는 `파워 타워` 와 `기본 타워` 를 찾아 `기본 타워` 의 상태를 갱신한다.
        - 연결 알고리즘
            - 배치한 타워가 파워타워나 링크 타워라면 단절점 여부를 확인하고 단절점이면 강화 경로 구하기 알고리즘을 적용한다.
            - 기본 타워라면 링킹된 링크 타워를 거슬러 올라 파워 타워를 확인한다.
             

